2025-04-21 17:30:03,929 | INFO | Job Started
2025-04-21 17:30:03,929 | INFO | Logging run: /rds/general/user/psp20/home/Brain-Network/runs/resnet_m48_20250421-173003
2025-04-21 17:30:03,929 | INFO | Config:
{
  "seed": 42,
  "run_name": "resnet_m48",
  "model_type": "resnet18",
  "optimizer": "adam",
  "scheduler": "ReduceLROnPlateau",
  "criterion": "CE",
  "label_smoothing": 0.1,
  "train_split": 0.9,
  "batch_size": 256,
  "num_workers": 2,
  "lr": 0.001,
  "epochs": 50,
  "ema": false,
  "early_stopping": true,
  "min_diff": 0.001,
  "writer": true,
  "patience": 10,
  "use_flex": false,
  "use_pos_embed": true,
  "add_dropout": false,
  "mlp_end": false,
  "add_cls_token": true,
  "num_layers": 2,
  "trans_dropout_ratio": 0.0,
  "standard_scale": true,
  "transform_type": "custom",
  "downsample_fraction": 0,
  "few_shot": false,
  "attacker": "PGD",
  "epsilon": 0.05,
  "gaussian_std": false
}
2025-04-21 17:30:04,065 | INFO | Using device: cuda
2025-04-21 17:30:04,066 | INFO | Training for 50 epochs
2025-04-21 17:30:04,066 | INFO | Debug mode: False
2025-04-21 17:30:04,066 | INFO | Downsampling by: 0
2025-04-21 17:30:04,349 | INFO | Using custom transform
2025-04-21 17:30:06,045 | INFO | Full train/val size with downsampling (0): 50000
2025-04-21 17:30:08,170 | INFO | Label smoothing: 0.1
2025-04-21 17:30:16,764 | INFO | Epoch 1: Train Loss=1.6041, Train Acc=48.93% | Val Loss=1.4370, Val Acc=57.66% | Time: 8.59s
2025-04-21 17:30:16,765 | INFO | New best model saved (val loss = 1.4370)
2025-04-21 17:30:23,226 | INFO | Epoch 2: Train Loss=1.2518, Train Acc=66.07% | Val Loss=1.5493, Val Acc=55.42% | Time: 6.46s
2025-04-21 17:30:29,711 | INFO | Epoch 3: Train Loss=1.0965, Train Acc=73.75% | Val Loss=1.1444, Val Acc=71.58% | Time: 6.48s
2025-04-21 17:30:29,712 | INFO | New best model saved (val loss = 1.1444)
2025-04-21 17:30:36,253 | INFO | Epoch 4: Train Loss=1.0039, Train Acc=78.00% | Val Loss=1.0786, Val Acc=74.00% | Time: 6.54s
2025-04-21 17:30:36,254 | INFO | New best model saved (val loss = 1.0786)
2025-04-21 17:30:42,747 | INFO | Epoch 5: Train Loss=0.9437, Train Acc=81.04% | Val Loss=0.9756, Val Acc=79.16% | Time: 6.49s
2025-04-21 17:30:42,748 | INFO | New best model saved (val loss = 0.9756)
2025-04-21 17:30:49,241 | INFO | Epoch 6: Train Loss=0.9014, Train Acc=82.49% | Val Loss=0.9893, Val Acc=78.96% | Time: 6.49s
2025-04-21 17:30:55,744 | INFO | Epoch 7: Train Loss=0.8672, Train Acc=84.21% | Val Loss=0.9110, Val Acc=81.54% | Time: 6.50s
2025-04-21 17:30:55,745 | INFO | New best model saved (val loss = 0.9110)
2025-04-21 17:31:02,268 | INFO | Epoch 8: Train Loss=0.8399, Train Acc=85.36% | Val Loss=0.9908, Val Acc=78.26% | Time: 6.52s
2025-04-21 17:31:08,765 | INFO | Epoch 9: Train Loss=0.8184, Train Acc=86.33% | Val Loss=0.9730, Val Acc=79.56% | Time: 6.50s
2025-04-21 17:31:15,257 | INFO | Epoch 10: Train Loss=0.7952, Train Acc=87.41% | Val Loss=0.9471, Val Acc=80.44% | Time: 6.49s
2025-04-21 17:31:21,784 | INFO | Epoch 11: Train Loss=0.7750, Train Acc=88.22% | Val Loss=1.0237, Val Acc=77.30% | Time: 6.53s
2025-04-21 17:31:28,281 | INFO | Epoch 12: Train Loss=0.6837, Train Acc=92.37% | Val Loss=0.7285, Val Acc=90.30% | Time: 6.50s
2025-04-21 17:31:28,282 | INFO | New best model saved (val loss = 0.7285)
2025-04-21 17:31:34,781 | INFO | Epoch 13: Train Loss=0.6553, Train Acc=93.52% | Val Loss=0.7195, Val Acc=90.60% | Time: 6.50s
2025-04-21 17:31:34,782 | INFO | New best model saved (val loss = 0.7195)
2025-04-21 17:31:41,284 | INFO | Epoch 14: Train Loss=0.6421, Train Acc=94.12% | Val Loss=0.7124, Val Acc=90.78% | Time: 6.50s
2025-04-21 17:31:41,285 | INFO | New best model saved (val loss = 0.7124)
2025-04-21 17:31:47,792 | INFO | Epoch 15: Train Loss=0.6321, Train Acc=94.52% | Val Loss=0.7151, Val Acc=90.56% | Time: 6.51s
2025-04-21 17:31:54,294 | INFO | Epoch 16: Train Loss=0.6232, Train Acc=94.95% | Val Loss=0.7212, Val Acc=90.58% | Time: 6.50s
2025-04-21 17:32:00,815 | INFO | Epoch 17: Train Loss=0.6143, Train Acc=95.35% | Val Loss=0.7122, Val Acc=91.04% | Time: 6.52s
2025-04-21 17:32:00,816 | INFO | New best model saved (val loss = 0.7122)
2025-04-21 17:32:07,311 | INFO | Epoch 18: Train Loss=0.6087, Train Acc=95.58% | Val Loss=0.7168, Val Acc=90.64% | Time: 6.49s
2025-04-21 17:32:13,810 | INFO | Epoch 19: Train Loss=0.6030, Train Acc=95.76% | Val Loss=0.7132, Val Acc=90.80% | Time: 6.50s
2025-04-21 17:32:20,321 | INFO | Epoch 20: Train Loss=0.5972, Train Acc=96.03% | Val Loss=0.7060, Val Acc=91.34% | Time: 6.51s
2025-04-21 17:32:20,322 | INFO | New best model saved (val loss = 0.7060)
2025-04-21 17:32:26,913 | INFO | Epoch 21: Train Loss=0.5886, Train Acc=96.42% | Val Loss=0.7036, Val Acc=91.46% | Time: 6.59s
2025-04-21 17:32:26,914 | INFO | New best model saved (val loss = 0.7036)
2025-04-21 17:32:33,421 | INFO | Epoch 22: Train Loss=0.5851, Train Acc=96.58% | Val Loss=0.7110, Val Acc=91.34% | Time: 6.51s
2025-04-21 17:32:39,924 | INFO | Epoch 23: Train Loss=0.5803, Train Acc=96.81% | Val Loss=0.7157, Val Acc=90.86% | Time: 6.50s
2025-04-21 17:32:46,444 | INFO | Epoch 24: Train Loss=0.5769, Train Acc=96.98% | Val Loss=0.7124, Val Acc=91.44% | Time: 6.52s
2025-04-21 17:32:52,974 | INFO | Epoch 25: Train Loss=0.5722, Train Acc=97.15% | Val Loss=0.7069, Val Acc=91.26% | Time: 6.53s
2025-04-21 17:32:59,504 | INFO | Epoch 26: Train Loss=0.5568, Train Acc=97.78% | Val Loss=0.6919, Val Acc=92.42% | Time: 6.53s
2025-04-21 17:32:59,505 | INFO | New best model saved (val loss = 0.6919)
2025-04-21 17:33:06,039 | INFO | Epoch 27: Train Loss=0.5520, Train Acc=98.07% | Val Loss=0.6973, Val Acc=91.96% | Time: 6.53s
2025-04-21 17:33:12,537 | INFO | Epoch 28: Train Loss=0.5498, Train Acc=98.09% | Val Loss=0.6986, Val Acc=91.84% | Time: 6.50s
2025-04-21 17:33:19,040 | INFO | Epoch 29: Train Loss=0.5495, Train Acc=98.17% | Val Loss=0.6999, Val Acc=92.30% | Time: 6.50s
2025-04-21 17:33:25,576 | INFO | Epoch 30: Train Loss=0.5464, Train Acc=98.29% | Val Loss=0.6945, Val Acc=91.96% | Time: 6.54s
2025-04-21 17:33:32,091 | INFO | Epoch 31: Train Loss=0.5447, Train Acc=98.30% | Val Loss=0.6968, Val Acc=92.08% | Time: 6.51s
2025-04-21 17:33:38,602 | INFO | Epoch 32: Train Loss=0.5447, Train Acc=98.32% | Val Loss=0.7039, Val Acc=91.28% | Time: 6.51s
2025-04-21 17:33:45,114 | INFO | Epoch 33: Train Loss=0.5446, Train Acc=98.36% | Val Loss=0.6963, Val Acc=91.86% | Time: 6.51s
2025-04-21 17:33:51,637 | INFO | Epoch 34: Train Loss=0.5434, Train Acc=98.38% | Val Loss=0.6964, Val Acc=92.12% | Time: 6.52s
2025-04-21 17:33:58,149 | INFO | Epoch 35: Train Loss=0.5439, Train Acc=98.34% | Val Loss=0.7023, Val Acc=91.90% | Time: 6.51s
2025-04-21 17:34:04,648 | INFO | Epoch 36: Train Loss=0.5428, Train Acc=98.44% | Val Loss=0.6908, Val Acc=92.36% | Time: 6.50s
2025-04-21 17:34:04,649 | INFO | New best model saved (val loss = 0.6908)
2025-04-21 17:34:11,220 | INFO | Epoch 37: Train Loss=0.5437, Train Acc=98.34% | Val Loss=0.6972, Val Acc=91.94% | Time: 6.57s
2025-04-21 17:34:17,721 | INFO | Epoch 38: Train Loss=0.5429, Train Acc=98.43% | Val Loss=0.7001, Val Acc=91.86% | Time: 6.50s
2025-04-21 17:34:24,275 | INFO | Epoch 39: Train Loss=0.5450, Train Acc=98.35% | Val Loss=0.6992, Val Acc=91.90% | Time: 6.55s
2025-04-21 17:34:30,854 | INFO | Epoch 40: Train Loss=0.5429, Train Acc=98.47% | Val Loss=0.6991, Val Acc=92.14% | Time: 6.58s
2025-04-21 17:34:37,520 | INFO | Epoch 41: Train Loss=0.5441, Train Acc=98.40% | Val Loss=0.6977, Val Acc=91.92% | Time: 6.67s
2025-04-21 17:34:44,096 | INFO | Epoch 42: Train Loss=0.5445, Train Acc=98.37% | Val Loss=0.6965, Val Acc=92.02% | Time: 6.58s
2025-04-21 17:34:50,724 | INFO | Epoch 43: Train Loss=0.5441, Train Acc=98.36% | Val Loss=0.6978, Val Acc=91.80% | Time: 6.63s
2025-04-21 17:34:57,402 | INFO | Epoch 44: Train Loss=0.5440, Train Acc=98.40% | Val Loss=0.6949, Val Acc=91.82% | Time: 6.68s
2025-04-21 17:35:03,995 | INFO | Epoch 45: Train Loss=0.5445, Train Acc=98.36% | Val Loss=0.6972, Val Acc=92.06% | Time: 6.59s
2025-04-21 17:35:10,580 | INFO | Epoch 46: Train Loss=0.5431, Train Acc=98.39% | Val Loss=0.6992, Val Acc=92.12% | Time: 6.58s
2025-04-21 17:35:10,580 | INFO | Early stopping triggered at epoch 46
2025-04-21 17:35:10,646 | INFO | Best model with lowest val loss 0.6907728850841522 at 35 epoch is saved.
2025-04-21 17:35:24,558 | INFO | Test Accuracy: 12.90%
2025-04-21 17:35:24,627 | INFO | Last model with val loss 0.6992158323526383 at 45 epoch is saved.
2025-04-21 17:35:37,492 | INFO | Test Accuracy: 13.01%
2025-04-21 17:35:37,502 | INFO | 
Job Completed
