2025-04-21 19:09:49,828 | INFO | Job Started
2025-04-21 19:09:49,828 | INFO | Logging run: /rds/general/user/psp20/home/Brain-Network/runs/zoom_m60_20250421-190949
2025-04-21 19:09:49,828 | INFO | Config:
{
  "seed": 42,
  "run_name": "zoom_m60",
  "model_type": "zoom",
  "optimizer": "adam",
  "scheduler": "ReduceLROnPlateau",
  "criterion": "CE",
  "label_smoothing": 0.1,
  "train_split": 0.9,
  "batch_size": 256,
  "num_workers": 2,
  "lr": 0.001,
  "epochs": 50,
  "ema": false,
  "early_stopping": true,
  "min_diff": 0.001,
  "writer": true,
  "patience": 10,
  "use_flex": false,
  "use_pos_embed": true,
  "add_dropout": false,
  "mlp_end": false,
  "add_cls_token": true,
  "num_layers": 2,
  "trans_dropout_ratio": 0.0,
  "standard_scale": true,
  "resnet_layers": 4,
  "multiscale_tokenisation": true,
  "gamma_per_head": true,
  "use_token_mixer": true,
  "remove_zoom": false,
  "transform_type": "custom",
  "downsample_fraction": 0,
  "few_shot": false,
  "freeze_resnet_early": false,
  "attacker": false,
  "epsilon": false,
  "gaussian_std": false
}
2025-04-21 19:09:49,989 | INFO | Using device: cuda
2025-04-21 19:09:49,989 | INFO | Training for 50 epochs
2025-04-21 19:09:49,989 | INFO | Debug mode: False
2025-04-21 19:09:49,989 | INFO | Downsampling by: 0
2025-04-21 19:09:51,164 | INFO | Using custom transform
2025-04-21 19:09:52,909 | INFO | Full train/val size with downsampling (0): 50000
2025-04-21 19:09:52,911 | INFO | Label smoothing: 0.1
2025-04-21 19:10:09,762 | INFO | Epoch 1: Train Loss=1.8820, Train Acc=31.42% | Val Loss=1.8476, Val Acc=36.50% | Time: 16.85s
2025-04-21 19:10:09,763 | INFO | New best model saved (val loss = 1.8476)
2025-04-21 19:10:23,073 | INFO | Epoch 2: Train Loss=1.4995, Train Acc=53.24% | Val Loss=1.3906, Val Acc=58.94% | Time: 13.31s
2025-04-21 19:10:23,074 | INFO | New best model saved (val loss = 1.3906)
2025-04-21 19:10:36,399 | INFO | Epoch 3: Train Loss=1.2762, Train Acc=64.66% | Val Loss=1.2970, Val Acc=64.20% | Time: 13.32s
2025-04-21 19:10:36,400 | INFO | New best model saved (val loss = 1.2970)
2025-04-21 19:10:49,725 | INFO | Epoch 4: Train Loss=1.1529, Train Acc=70.61% | Val Loss=1.2720, Val Acc=66.82% | Time: 13.32s
2025-04-21 19:10:49,726 | INFO | New best model saved (val loss = 1.2720)
2025-04-21 19:11:03,097 | INFO | Epoch 5: Train Loss=1.0568, Train Acc=75.50% | Val Loss=1.2672, Val Acc=65.62% | Time: 13.37s
2025-04-21 19:11:03,098 | INFO | New best model saved (val loss = 1.2672)
2025-04-21 19:11:16,438 | INFO | Epoch 6: Train Loss=0.9903, Train Acc=78.48% | Val Loss=1.0477, Val Acc=76.14% | Time: 13.34s
2025-04-21 19:11:16,440 | INFO | New best model saved (val loss = 1.0477)
2025-04-21 19:11:29,821 | INFO | Epoch 7: Train Loss=0.9336, Train Acc=80.96% | Val Loss=1.0636, Val Acc=75.86% | Time: 13.38s
2025-04-21 19:11:43,166 | INFO | Epoch 8: Train Loss=0.9061, Train Acc=82.54% | Val Loss=0.9563, Val Acc=79.94% | Time: 13.34s
2025-04-21 19:11:43,167 | INFO | New best model saved (val loss = 0.9563)
2025-04-21 19:11:56,509 | INFO | Epoch 9: Train Loss=0.8738, Train Acc=83.82% | Val Loss=0.9013, Val Acc=82.90% | Time: 13.34s
2025-04-21 19:11:56,510 | INFO | New best model saved (val loss = 0.9013)
2025-04-21 19:12:09,877 | INFO | Epoch 10: Train Loss=0.8528, Train Acc=84.68% | Val Loss=0.9480, Val Acc=80.52% | Time: 13.36s
2025-04-21 19:12:23,254 | INFO | Epoch 11: Train Loss=0.8293, Train Acc=85.80% | Val Loss=0.9188, Val Acc=81.12% | Time: 13.37s
2025-04-21 19:12:36,605 | INFO | Epoch 12: Train Loss=0.8084, Train Acc=86.76% | Val Loss=0.9101, Val Acc=81.84% | Time: 13.35s
2025-04-21 19:12:50,023 | INFO | Epoch 13: Train Loss=0.7895, Train Acc=87.20% | Val Loss=0.9381, Val Acc=81.08% | Time: 13.41s
2025-04-21 19:13:03,396 | INFO | Epoch 14: Train Loss=0.6993, Train Acc=91.44% | Val Loss=0.7466, Val Acc=89.02% | Time: 13.37s
2025-04-21 19:13:03,397 | INFO | New best model saved (val loss = 0.7466)
2025-04-21 19:13:16,772 | INFO | Epoch 15: Train Loss=0.6687, Train Acc=92.82% | Val Loss=0.7399, Val Acc=89.36% | Time: 13.37s
2025-04-21 19:13:16,773 | INFO | New best model saved (val loss = 0.7399)
2025-04-21 19:13:30,146 | INFO | Epoch 16: Train Loss=0.6548, Train Acc=93.44% | Val Loss=0.7330, Val Acc=89.80% | Time: 13.37s
2025-04-21 19:13:30,147 | INFO | New best model saved (val loss = 0.7330)
2025-04-21 19:13:43,523 | INFO | Epoch 17: Train Loss=0.6487, Train Acc=93.61% | Val Loss=0.7317, Val Acc=89.70% | Time: 13.37s
2025-04-21 19:13:43,524 | INFO | New best model saved (val loss = 0.7317)
2025-04-21 19:13:56,882 | INFO | Epoch 18: Train Loss=0.6386, Train Acc=94.09% | Val Loss=0.7354, Val Acc=89.92% | Time: 13.35s
2025-04-21 19:14:10,227 | INFO | Epoch 19: Train Loss=0.6334, Train Acc=94.30% | Val Loss=0.7454, Val Acc=89.16% | Time: 13.34s
2025-04-21 19:14:23,552 | INFO | Epoch 20: Train Loss=0.6261, Train Acc=94.65% | Val Loss=0.7371, Val Acc=90.08% | Time: 13.32s
2025-04-21 19:14:36,923 | INFO | Epoch 21: Train Loss=0.6191, Train Acc=94.99% | Val Loss=0.7347, Val Acc=90.04% | Time: 13.37s
2025-04-21 19:14:50,281 | INFO | Epoch 22: Train Loss=0.6054, Train Acc=95.61% | Val Loss=0.7242, Val Acc=90.60% | Time: 13.35s
2025-04-21 19:14:50,282 | INFO | New best model saved (val loss = 0.7242)
2025-04-21 19:15:03,764 | INFO | Epoch 23: Train Loss=0.6009, Train Acc=95.91% | Val Loss=0.7262, Val Acc=90.52% | Time: 13.48s
2025-04-21 19:15:17,131 | INFO | Epoch 24: Train Loss=0.5989, Train Acc=95.93% | Val Loss=0.7274, Val Acc=90.28% | Time: 13.36s
2025-04-21 19:15:30,545 | INFO | Epoch 25: Train Loss=0.5998, Train Acc=95.83% | Val Loss=0.7302, Val Acc=90.34% | Time: 13.40s
2025-04-21 19:15:43,923 | INFO | Epoch 26: Train Loss=0.5942, Train Acc=96.19% | Val Loss=0.7276, Val Acc=90.24% | Time: 13.37s
2025-04-21 19:15:57,354 | INFO | Epoch 27: Train Loss=0.5937, Train Acc=96.14% | Val Loss=0.7353, Val Acc=89.96% | Time: 13.42s
2025-04-21 19:16:10,723 | INFO | Epoch 28: Train Loss=0.5927, Train Acc=96.21% | Val Loss=0.7291, Val Acc=90.36% | Time: 13.36s
2025-04-21 19:16:24,085 | INFO | Epoch 29: Train Loss=0.5949, Train Acc=96.06% | Val Loss=0.7218, Val Acc=90.32% | Time: 13.35s
2025-04-21 19:16:24,086 | INFO | New best model saved (val loss = 0.7218)
2025-04-21 19:16:37,440 | INFO | Epoch 30: Train Loss=0.5943, Train Acc=96.13% | Val Loss=0.7232, Val Acc=90.82% | Time: 13.35s
2025-04-21 19:16:50,800 | INFO | Epoch 31: Train Loss=0.5920, Train Acc=96.34% | Val Loss=0.7300, Val Acc=90.34% | Time: 13.35s
2025-04-21 19:17:04,199 | INFO | Epoch 32: Train Loss=0.5929, Train Acc=96.15% | Val Loss=0.7287, Val Acc=90.42% | Time: 13.39s
2025-04-21 19:17:17,561 | INFO | Epoch 33: Train Loss=0.5932, Train Acc=96.14% | Val Loss=0.7220, Val Acc=90.66% | Time: 13.35s
2025-04-21 19:17:30,917 | INFO | Epoch 34: Train Loss=0.5936, Train Acc=96.06% | Val Loss=0.7283, Val Acc=90.32% | Time: 13.35s
2025-04-21 19:17:44,270 | INFO | Epoch 35: Train Loss=0.5903, Train Acc=96.27% | Val Loss=0.7230, Val Acc=90.66% | Time: 13.34s
2025-04-21 19:17:57,606 | INFO | Epoch 36: Train Loss=0.5928, Train Acc=96.23% | Val Loss=0.7324, Val Acc=90.42% | Time: 13.33s
2025-04-21 19:18:10,978 | INFO | Epoch 37: Train Loss=0.5929, Train Acc=96.24% | Val Loss=0.7325, Val Acc=90.22% | Time: 13.36s
2025-04-21 19:18:24,357 | INFO | Epoch 38: Train Loss=0.5915, Train Acc=96.21% | Val Loss=0.7280, Val Acc=90.06% | Time: 13.37s
2025-04-21 19:18:37,737 | INFO | Epoch 39: Train Loss=0.5936, Train Acc=96.14% | Val Loss=0.7180, Val Acc=90.98% | Time: 13.37s
2025-04-21 19:18:37,738 | INFO | New best model saved (val loss = 0.7180)
2025-04-21 19:18:51,126 | INFO | Epoch 40: Train Loss=0.5928, Train Acc=96.19% | Val Loss=0.7314, Val Acc=89.98% | Time: 13.38s
2025-04-21 19:19:04,511 | INFO | Epoch 41: Train Loss=0.5916, Train Acc=96.24% | Val Loss=0.7328, Val Acc=90.22% | Time: 13.38s
2025-04-21 19:19:17,878 | INFO | Epoch 42: Train Loss=0.5910, Train Acc=96.23% | Val Loss=0.7275, Val Acc=90.00% | Time: 13.36s
2025-04-21 19:19:31,238 | INFO | Epoch 43: Train Loss=0.5925, Train Acc=96.16% | Val Loss=0.7337, Val Acc=90.18% | Time: 13.35s
2025-04-21 19:19:44,605 | INFO | Epoch 44: Train Loss=0.5929, Train Acc=96.14% | Val Loss=0.7268, Val Acc=90.34% | Time: 13.36s
2025-04-21 19:19:58,002 | INFO | Epoch 45: Train Loss=0.5915, Train Acc=96.17% | Val Loss=0.7242, Val Acc=90.84% | Time: 13.39s
2025-04-21 19:20:11,384 | INFO | Epoch 46: Train Loss=0.5940, Train Acc=96.13% | Val Loss=0.7252, Val Acc=90.74% | Time: 13.37s
2025-04-21 19:20:24,819 | INFO | Epoch 47: Train Loss=0.5923, Train Acc=96.26% | Val Loss=0.7175, Val Acc=90.84% | Time: 13.42s
2025-04-21 19:20:24,821 | INFO | New best model saved (val loss = 0.7175)
2025-04-21 19:20:38,258 | INFO | Epoch 48: Train Loss=0.5926, Train Acc=96.22% | Val Loss=0.7265, Val Acc=90.28% | Time: 13.43s
2025-04-21 19:20:51,639 | INFO | Epoch 49: Train Loss=0.5910, Train Acc=96.22% | Val Loss=0.7183, Val Acc=90.72% | Time: 13.37s
2025-04-21 19:20:51,639 | INFO | Early stopping triggered at epoch 49
2025-04-21 19:20:51,715 | INFO | Best model with lowest val loss 0.7175009071826934 at 46 epoch is saved.
2025-04-21 19:20:53,138 | INFO | Test Accuracy: 90.86%
2025-04-21 19:20:53,213 | INFO | Last model with val loss 0.7182985544204712 at 48 epoch is saved.
2025-04-21 19:20:54,522 | INFO | Test Accuracy: 90.86%
2025-04-21 19:20:54,534 | INFO | 
Job Completed
