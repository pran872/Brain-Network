2025-05-29 21:32:09,638 | INFO | Job Started
2025-05-29 21:32:09,638 | INFO | Logging run: /rds/general/user/psp20/home/Brain-Network/runs/zoomvit_4_5_acc_20250529-213209
2025-05-29 21:32:09,935 | INFO | Using device: cuda
2025-05-29 21:32:09,935 | INFO | Training for 100 epochs
2025-05-29 21:32:09,935 | INFO | Debug mode: False
2025-05-29 21:32:09,935 | INFO | Downsampling by: 0
2025-05-29 21:32:09,935 | INFO | Auxiliary loss: {'attention_entropy_loss': 0.1}
2025-05-29 21:32:09,935 | INFO | Train transforms: 
	Compose(
    RandomCrop(size=(32, 32), padding=4)
    RandomHorizontalFlip(p=0.5)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2025-05-29 21:32:09,936 | INFO | Test transforms: 
	Compose(
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2025-05-29 21:32:12,371 | INFO | Full train/val size with downsampling (0): 50000
2025-05-29 21:32:12,409 | INFO | Using pretrained weights
2025-05-29 21:32:13,692 | INFO | Using mixup function and SoftTargetCrossEntropy
2025-05-29 21:32:13,692 | INFO | Auxiliary loss: {'attention_entropy_loss': 0.1}
2025-05-29 21:32:34,583 | INFO | Epoch: 1 | Time: 20.89s
2025-05-29 21:32:34,583 | INFO | Train Loss=2.3468, Train Acc=35.00%
2025-05-29 21:32:34,583 | INFO | Val Loss=1.8303, Val Acc=50.96%
2025-05-29 21:32:34,583 | INFO | Train Gamma Loss=0.4048 | Val Gamma Loss=0.4159001410007477
2025-05-29 21:32:34,585 | INFO | New best model saved (val loss = 1.8303)
2025-05-29 21:32:49,176 | INFO | Epoch: 2 | Time: 14.59s
2025-05-29 21:32:49,176 | INFO | Train Loss=2.0715, Train Acc=50.13%
2025-05-29 21:32:49,176 | INFO | Val Loss=1.4990, Val Acc=60.40%
2025-05-29 21:32:49,176 | INFO | Train Gamma Loss=0.3801 | Val Gamma Loss=0.3152930736541748
2025-05-29 21:32:49,178 | INFO | New best model saved (val loss = 1.4990)
2025-05-29 21:33:03,808 | INFO | Epoch: 3 | Time: 14.63s
2025-05-29 21:33:03,809 | INFO | Train Loss=1.4270, Train Acc=66.17%
2025-05-29 21:33:03,809 | INFO | Val Loss=0.6306, Val Acc=80.60%
2025-05-29 21:33:03,809 | INFO | Train Gamma Loss=0.0147 | Val Gamma Loss=0.005399229936301708
2025-05-29 21:33:03,810 | INFO | New best model saved (val loss = 0.6306)
2025-05-29 21:33:18,413 | INFO | Epoch: 4 | Time: 14.60s
2025-05-29 21:33:18,413 | INFO | Train Loss=1.2787, Train Acc=73.91%
2025-05-29 21:33:18,413 | INFO | Val Loss=0.5042, Val Acc=85.76%
2025-05-29 21:33:18,413 | INFO | Train Gamma Loss=-0.0066 | Val Gamma Loss=0.003568215062841773
2025-05-29 21:33:18,415 | INFO | New best model saved (val loss = 0.5042)
2025-05-29 21:33:32,898 | INFO | Epoch: 5 | Time: 14.48s
2025-05-29 21:33:32,898 | INFO | Train Loss=1.2145, Train Acc=77.42%
2025-05-29 21:33:32,898 | INFO | Val Loss=0.5055, Val Acc=86.64%
2025-05-29 21:33:32,898 | INFO | Train Gamma Loss=-0.0082 | Val Gamma Loss=0.0023451976012438536
2025-05-29 21:33:47,492 | INFO | Epoch: 6 | Time: 14.59s
2025-05-29 21:33:47,492 | INFO | Train Loss=1.1605, Train Acc=79.32%
2025-05-29 21:33:47,492 | INFO | Val Loss=0.5361, Val Acc=86.28%
2025-05-29 21:33:47,492 | INFO | Train Gamma Loss=-0.0090 | Val Gamma Loss=0.0018384248251095414
2025-05-29 21:34:02,032 | INFO | Epoch: 7 | Time: 14.54s
2025-05-29 21:34:02,033 | INFO | Train Loss=1.1194, Train Acc=81.28%
2025-05-29 21:34:02,033 | INFO | Val Loss=0.5643, Val Acc=85.98%
2025-05-29 21:34:02,033 | INFO | Train Gamma Loss=-0.0095 | Val Gamma Loss=0.0012424441520124674
2025-05-29 21:34:16,685 | INFO | Epoch: 8 | Time: 14.65s
2025-05-29 21:34:16,685 | INFO | Train Loss=1.0817, Train Acc=82.62%
2025-05-29 21:34:16,685 | INFO | Val Loss=0.4862, Val Acc=88.36%
2025-05-29 21:34:16,686 | INFO | Train Gamma Loss=-0.0097 | Val Gamma Loss=0.0011092278873547912
2025-05-29 21:34:16,687 | INFO | New best model saved (val loss = 0.4862)
2025-05-29 21:34:31,253 | INFO | Epoch: 9 | Time: 14.55s
2025-05-29 21:34:31,253 | INFO | Train Loss=1.0805, Train Acc=83.58%
2025-05-29 21:34:31,253 | INFO | Val Loss=0.5404, Val Acc=84.86%
2025-05-29 21:34:31,253 | INFO | Train Gamma Loss=-0.0098 | Val Gamma Loss=0.0012192408321425319
2025-05-29 21:34:45,830 | INFO | Epoch: 10 | Time: 14.57s
2025-05-29 21:34:45,831 | INFO | Train Loss=1.1014, Train Acc=83.21%
2025-05-29 21:34:45,831 | INFO | Val Loss=0.4615, Val Acc=88.32%
2025-05-29 21:34:45,831 | INFO | Train Gamma Loss=-0.0099 | Val Gamma Loss=0.0009588654502294958
2025-05-29 21:34:45,832 | INFO | New best model saved (val loss = 0.4615)
2025-05-29 21:35:00,397 | INFO | Epoch: 11 | Time: 14.53s
2025-05-29 21:35:00,397 | INFO | Train Loss=1.0664, Train Acc=83.58%
2025-05-29 21:35:00,397 | INFO | Val Loss=0.4537, Val Acc=88.20%
2025-05-29 21:35:00,397 | INFO | Train Gamma Loss=-0.0100 | Val Gamma Loss=0.0008964505395852029
2025-05-29 21:35:00,399 | INFO | New best model saved (val loss = 0.4537)
2025-05-29 21:35:15,014 | INFO | Epoch: 12 | Time: 14.60s
2025-05-29 21:35:15,014 | INFO | Train Loss=1.0405, Train Acc=85.32%
2025-05-29 21:35:15,014 | INFO | Val Loss=0.4078, Val Acc=89.78%
2025-05-29 21:35:15,015 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.0007947959238663316
2025-05-29 21:35:15,016 | INFO | New best model saved (val loss = 0.4078)
2025-05-29 21:35:29,667 | INFO | Epoch: 13 | Time: 14.65s
2025-05-29 21:35:29,667 | INFO | Train Loss=1.0641, Train Acc=84.12%
2025-05-29 21:35:29,667 | INFO | Val Loss=0.3976, Val Acc=90.72%
2025-05-29 21:35:29,668 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.0005391498561948538
2025-05-29 21:35:29,669 | INFO | New best model saved (val loss = 0.3976)
2025-05-29 21:35:44,335 | INFO | Epoch: 14 | Time: 14.66s
2025-05-29 21:35:44,336 | INFO | Train Loss=1.0851, Train Acc=83.15%
2025-05-29 21:35:44,336 | INFO | Val Loss=0.4803, Val Acc=91.02%
2025-05-29 21:35:44,336 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.0003962111659348011
2025-05-29 21:35:58,970 | INFO | Epoch: 15 | Time: 14.63s
2025-05-29 21:35:58,970 | INFO | Train Loss=1.0440, Train Acc=83.20%
2025-05-29 21:35:58,971 | INFO | Val Loss=0.4383, Val Acc=89.32%
2025-05-29 21:35:58,971 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.00035363584174774587
2025-05-29 21:36:13,648 | INFO | Epoch: 16 | Time: 14.67s
2025-05-29 21:36:13,648 | INFO | Train Loss=1.0407, Train Acc=83.77%
2025-05-29 21:36:13,648 | INFO | Val Loss=0.5117, Val Acc=86.62%
2025-05-29 21:36:13,648 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.0005155248800292611
2025-05-29 21:36:28,297 | INFO | Epoch: 17 | Time: 14.64s
2025-05-29 21:36:28,297 | INFO | Train Loss=1.0710, Train Acc=81.84%
2025-05-29 21:36:28,297 | INFO | Val Loss=0.4136, Val Acc=88.68%
2025-05-29 21:36:28,297 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.0002985581522807479
2025-05-29 21:36:42,731 | INFO | Epoch: 18 | Time: 14.43s
2025-05-29 21:36:42,731 | INFO | Train Loss=1.0896, Train Acc=82.68%
2025-05-29 21:36:42,731 | INFO | Val Loss=0.4509, Val Acc=89.80%
2025-05-29 21:36:42,731 | INFO | Train Gamma Loss=-0.0103 | Val Gamma Loss=0.00025119041674770415
2025-05-29 21:36:57,351 | INFO | Epoch: 19 | Time: 14.61s
2025-05-29 21:36:57,351 | INFO | Train Loss=1.0054, Train Acc=85.80%
2025-05-29 21:36:57,351 | INFO | Val Loss=0.4342, Val Acc=90.52%
2025-05-29 21:36:57,352 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.00029155428637750447
2025-05-29 21:37:11,938 | INFO | Epoch: 20 | Time: 14.58s
2025-05-29 21:37:11,938 | INFO | Train Loss=0.9897, Train Acc=86.44%
2025-05-29 21:37:11,938 | INFO | Val Loss=0.3690, Val Acc=90.82%
2025-05-29 21:37:11,938 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.00026022581732831895
2025-05-29 21:37:11,940 | INFO | New best model saved (val loss = 0.3690)
2025-05-29 21:37:26,577 | INFO | Epoch: 21 | Time: 14.63s
2025-05-29 21:37:26,577 | INFO | Train Loss=0.9737, Train Acc=86.24%
2025-05-29 21:37:26,577 | INFO | Val Loss=0.3960, Val Acc=90.92%
2025-05-29 21:37:26,578 | INFO | Train Gamma Loss=-0.0103 | Val Gamma Loss=0.0002045756409643218
2025-05-29 21:37:41,065 | INFO | Epoch: 22 | Time: 14.48s
2025-05-29 21:37:41,065 | INFO | Train Loss=1.0524, Train Acc=83.90%
2025-05-29 21:37:41,065 | INFO | Val Loss=0.3646, Val Acc=91.74%
2025-05-29 21:37:41,065 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.00016714220691937953
2025-05-29 21:37:41,067 | INFO | New best model saved (val loss = 0.3646)
2025-05-29 21:37:55,635 | INFO | Epoch: 23 | Time: 14.56s
2025-05-29 21:37:55,635 | INFO | Train Loss=1.0155, Train Acc=85.81%
2025-05-29 21:37:55,635 | INFO | Val Loss=0.3645, Val Acc=91.28%
2025-05-29 21:37:55,635 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.00021232357539702207
2025-05-29 21:37:55,637 | INFO | New best model saved (val loss = 0.3645)
2025-05-29 21:38:10,231 | INFO | Epoch: 24 | Time: 14.58s
2025-05-29 21:38:10,231 | INFO | Train Loss=1.0188, Train Acc=85.20%
2025-05-29 21:38:10,231 | INFO | Val Loss=0.4334, Val Acc=89.84%
2025-05-29 21:38:10,231 | INFO | Train Gamma Loss=-0.0103 | Val Gamma Loss=0.00029046935378573835
2025-05-29 21:38:24,808 | INFO | Epoch: 25 | Time: 14.57s
2025-05-29 21:38:24,808 | INFO | Train Loss=0.9875, Train Acc=85.96%
2025-05-29 21:38:24,808 | INFO | Val Loss=0.4745, Val Acc=87.28%
2025-05-29 21:38:24,809 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.000376498035620898
2025-05-29 21:38:39,291 | INFO | Epoch: 26 | Time: 14.47s
2025-05-29 21:38:39,291 | INFO | Train Loss=0.9600, Train Acc=85.60%
2025-05-29 21:38:39,291 | INFO | Val Loss=0.5035, Val Acc=87.24%
2025-05-29 21:38:39,291 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.0009444030001759529
2025-05-29 21:38:53,835 | INFO | Epoch: 27 | Time: 14.54s
2025-05-29 21:38:53,835 | INFO | Train Loss=0.9265, Train Acc=87.08%
2025-05-29 21:38:53,835 | INFO | Val Loss=0.4568, Val Acc=87.22%
2025-05-29 21:38:53,835 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.00032224590540863574
2025-05-29 21:39:08,374 | INFO | Epoch: 28 | Time: 14.53s
2025-05-29 21:39:08,375 | INFO | Train Loss=1.1992, Train Acc=77.66%
2025-05-29 21:39:08,375 | INFO | Val Loss=0.6338, Val Acc=82.82%
2025-05-29 21:39:08,375 | INFO | Train Gamma Loss=-0.0098 | Val Gamma Loss=0.00021186871163081378
2025-05-29 21:39:22,972 | INFO | Epoch: 29 | Time: 14.59s
2025-05-29 21:39:22,972 | INFO | Train Loss=1.1053, Train Acc=82.39%
2025-05-29 21:39:22,972 | INFO | Val Loss=0.5726, Val Acc=83.74%
2025-05-29 21:39:22,972 | INFO | Train Gamma Loss=-0.0103 | Val Gamma Loss=0.00019784476899076253
2025-05-29 21:39:37,465 | INFO | Epoch: 30 | Time: 14.48s
2025-05-29 21:39:37,465 | INFO | Train Loss=1.0814, Train Acc=82.11%
2025-05-29 21:39:37,465 | INFO | Val Loss=0.3702, Val Acc=90.20%
2025-05-29 21:39:37,465 | INFO | Train Gamma Loss=-0.0103 | Val Gamma Loss=0.00033782896935008466
2025-05-29 21:39:51,895 | INFO | Epoch: 31 | Time: 14.42s
2025-05-29 21:39:51,895 | INFO | Train Loss=1.0486, Train Acc=82.74%
2025-05-29 21:39:51,895 | INFO | Val Loss=0.4502, Val Acc=88.36%
2025-05-29 21:39:51,896 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.00015383251593448222
2025-05-29 21:40:06,405 | INFO | Epoch: 32 | Time: 14.50s
2025-05-29 21:40:06,405 | INFO | Train Loss=1.5632, Train Acc=56.84%
2025-05-29 21:40:06,405 | INFO | Val Loss=1.6480, Val Acc=41.74%
2025-05-29 21:40:06,405 | INFO | Train Gamma Loss=-0.0102 | Val Gamma Loss=0.00023425773542840034
2025-05-29 21:40:21,012 | INFO | Epoch: 33 | Time: 14.60s
2025-05-29 21:40:21,012 | INFO | Train Loss=1.9926, Train Acc=31.79%
2025-05-29 21:40:21,012 | INFO | Val Loss=1.8682, Val Acc=29.00%
2025-05-29 21:40:21,012 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.0001770956296240911
2025-05-29 21:40:35,603 | INFO | Epoch: 34 | Time: 14.58s
2025-05-29 21:40:35,603 | INFO | Train Loss=1.9002, Train Acc=35.22%
2025-05-29 21:40:35,603 | INFO | Val Loss=1.4915, Val Acc=46.52%
2025-05-29 21:40:35,603 | INFO | Train Gamma Loss=-0.0105 | Val Gamma Loss=0.00014542842109221965
2025-05-29 21:40:50,107 | INFO | Epoch: 35 | Time: 14.49s
2025-05-29 21:40:50,107 | INFO | Train Loss=1.7196, Train Acc=46.12%
2025-05-29 21:40:50,107 | INFO | Val Loss=1.3997, Val Acc=51.48%
2025-05-29 21:40:50,107 | INFO | Train Gamma Loss=-0.0105 | Val Gamma Loss=0.0001556805509608239
2025-05-29 21:41:04,714 | INFO | Epoch: 36 | Time: 14.60s
2025-05-29 21:41:04,714 | INFO | Train Loss=1.6458, Train Acc=52.01%
2025-05-29 21:41:04,714 | INFO | Val Loss=1.1228, Val Acc=62.50%
2025-05-29 21:41:04,714 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.0004899742780253291
2025-05-29 21:41:19,291 | INFO | Epoch: 37 | Time: 14.57s
2025-05-29 21:41:19,291 | INFO | Train Loss=1.5321, Train Acc=57.72%
2025-05-29 21:41:19,291 | INFO | Val Loss=1.0774, Val Acc=66.66%
2025-05-29 21:41:19,291 | INFO | Train Gamma Loss=-0.0103 | Val Gamma Loss=0.00016168932779692113
2025-05-29 21:41:33,884 | INFO | Epoch: 38 | Time: 14.58s
2025-05-29 21:41:33,884 | INFO | Train Loss=1.4287, Train Acc=63.71%
2025-05-29 21:41:33,884 | INFO | Val Loss=0.8687, Val Acc=71.14%
2025-05-29 21:41:33,884 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.0005231633549556136
2025-05-29 21:41:48,553 | INFO | Epoch: 39 | Time: 14.66s
2025-05-29 21:41:48,553 | INFO | Train Loss=1.4420, Train Acc=64.34%
2025-05-29 21:41:48,553 | INFO | Val Loss=0.9781, Val Acc=68.80%
2025-05-29 21:41:48,553 | INFO | Train Gamma Loss=-0.0101 | Val Gamma Loss=0.0002843362162820995
2025-05-29 21:42:03,158 | INFO | Epoch: 40 | Time: 14.59s
2025-05-29 21:42:03,158 | INFO | Train Loss=1.3896, Train Acc=67.34%
2025-05-29 21:42:03,158 | INFO | Val Loss=0.8287, Val Acc=73.66%
2025-05-29 21:42:03,159 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.00020404723181854934
2025-05-29 21:42:17,658 | INFO | Epoch: 41 | Time: 14.49s
2025-05-29 21:42:17,658 | INFO | Train Loss=1.3638, Train Acc=68.72%
2025-05-29 21:42:17,658 | INFO | Val Loss=0.7127, Val Acc=79.10%
2025-05-29 21:42:17,658 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.00017542863497510552
2025-05-29 21:42:32,087 | INFO | Epoch: 42 | Time: 14.42s
2025-05-29 21:42:32,087 | INFO | Train Loss=1.3296, Train Acc=70.40%
2025-05-29 21:42:32,087 | INFO | Val Loss=0.6536, Val Acc=79.74%
2025-05-29 21:42:32,087 | INFO | Train Gamma Loss=-0.0104 | Val Gamma Loss=0.0002473857894074172
2025-05-29 21:42:32,087 | INFO | Early stopping triggered at epoch 42
2025-05-29 21:42:32,294 | INFO | Best model with lowest val loss 0.3645121410489082 at 22 epoch is saved.
2025-05-29 21:42:34,082 | INFO | Test Accuracy: 80.65%
2025-05-29 21:42:34,231 | INFO | Last model with val loss 0.6536469250917435 at 41 epoch is saved.
2025-05-29 21:42:35,246 | INFO | Test Accuracy: 80.65%
2025-05-29 21:42:35,258 | INFO | 
Job Completed
2025-05-29 22:01:21,733 | INFO | No test config present. Using train config.
2025-05-29 22:01:23,908 | INFO | Full train/val size with downsampling (0): 50000
2025-05-29 22:01:23,910 | INFO | Batch size: 32
2025-05-29 22:01:23,910 | INFO | Running these attacks:
2025-05-29 22:01:23,910 | INFO | {'FGSM': [0.01, 0.05, 0.1, 0.2], 'PGD': [0.01, 0.05, 0.1, 0.2], 'gaussian noise': [0.01, 0.05, 0.1, 0.2]}
2025-05-29 22:01:23,910 | INFO | 
Testing model: /rds/general/user/psp20/home/Brain-Network/runs/zoomvit_4_5_acc_20250529-213209/zoomvit_4_5_acc_20250529-213209_e22_best_model.pt
2025-05-29 22:01:23,910 | INFO | Running attack: FGSM, 0.01
2025-05-29 22:01:33,740 | INFO | Test accuracy: 38.71
2025-05-29 22:01:33,740 | INFO | Running attack: FGSM, 0.05
2025-05-29 22:01:42,239 | INFO | Test accuracy: 25.61
2025-05-29 22:01:42,239 | INFO | Running attack: FGSM, 0.1
2025-05-29 22:01:51,384 | INFO | Test accuracy: 17.76
2025-05-29 22:01:51,385 | INFO | Running attack: FGSM, 0.2
2025-05-29 22:02:01,167 | INFO | Test accuracy: 12.42
2025-05-29 22:02:01,167 | INFO | Running attack: PGD, 0.01
2025-05-29 22:02:44,410 | INFO | Test accuracy: 31.1
2025-05-29 22:02:44,410 | INFO | Running attack: PGD, 0.05
2025-05-29 22:03:35,145 | INFO | Test accuracy: 7.72
2025-05-29 22:03:35,145 | INFO | Running attack: PGD, 0.1
2025-05-29 22:04:19,784 | INFO | Test accuracy: 4.39
2025-05-29 22:04:19,784 | INFO | Running attack: PGD, 0.2
2025-05-29 22:05:03,085 | INFO | Test accuracy: 2.62
2025-05-29 22:05:03,085 | INFO | Running attack: gaussian noise, 0.01
2025-05-29 22:05:07,087 | INFO | Test accuracy: 43.18
2025-05-29 22:05:07,087 | INFO | Running attack: gaussian noise, 0.05
2025-05-29 22:05:10,700 | INFO | Test accuracy: 42.65
2025-05-29 22:05:10,719 | INFO | Running attack: gaussian noise, 0.1
2025-05-29 22:05:14,312 | INFO | Test accuracy: 40.21
2025-05-29 22:05:14,312 | INFO | Running attack: gaussian noise, 0.2
2025-05-29 22:05:17,724 | INFO | Test accuracy: 34.08
