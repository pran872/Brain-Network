2025-04-21 21:23:21,556 | INFO | Job Started
2025-04-21 21:23:21,556 | INFO | Logging run: /rds/general/user/psp20/home/Brain-Network/runs/brainit_m1_20250421-212321
2025-04-21 21:23:21,556 | INFO | Config:
{
  "seed": 42,
  "run_name": "brainit_m1",
  "model_type": "brainit",
  "optimizer": "adam",
  "scheduler": "ReduceLROnPlateau",
  "criterion": "CE",
  "label_smoothing": 0.1,
  "train_split": 0.9,
  "batch_size": 256,
  "num_workers": 2,
  "lr": 0.001,
  "epochs": 50,
  "ema": false,
  "early_stopping": true,
  "min_diff": 0.001,
  "writer": true,
  "patience": 10,
  "use_flex": false,
  "use_pos_embed": true,
  "add_dropout": false,
  "mlp_end": false,
  "add_cls_token": true,
  "num_layers": 2,
  "trans_dropout_ratio": 0.0,
  "standard_scale": true,
  "resnet_layers": 3,
  "multiscale_tokenisation": false,
  "gamma_per_head": false,
  "use_token_mixer": false,
  "remove_zoom": false,
  "transform_type": "foveation",
  "downsample_fraction": 0,
  "few_shot": false,
  "freeze_resnet_early": false,
  "attacker": false,
  "epsilon": false,
  "gaussian_std": false
}
2025-04-21 21:23:21,768 | INFO | Using device: cuda
2025-04-21 21:23:21,768 | INFO | Training for 50 epochs
2025-04-21 21:23:21,768 | INFO | Debug mode: False
2025-04-21 21:23:21,768 | INFO | Downsampling by: 0
2025-04-21 21:23:22,986 | INFO | Using foveation transform
2025-04-21 21:23:24,754 | INFO | Full train/val size with downsampling (0): 50000
2025-04-21 21:23:26,961 | INFO | Label smoothing: 0.1
2025-04-21 21:23:46,260 | INFO | Epoch 1: Train Loss=2.0101, Train Acc=25.80% | Val Loss=1.9122, Val Acc=30.52% | Time: 19.30s
2025-04-21 21:23:46,261 | INFO | New best model saved (val loss = 1.9122)
2025-04-21 21:24:03,676 | INFO | Epoch 2: Train Loss=1.7929, Train Acc=37.68% | Val Loss=1.7346, Val Acc=41.84% | Time: 17.42s
2025-04-21 21:24:03,677 | INFO | New best model saved (val loss = 1.7346)
2025-04-21 21:24:21,264 | INFO | Epoch 3: Train Loss=1.6200, Train Acc=47.64% | Val Loss=1.6204, Val Acc=48.50% | Time: 17.59s
2025-04-21 21:24:21,265 | INFO | New best model saved (val loss = 1.6204)
2025-04-21 21:24:38,705 | INFO | Epoch 4: Train Loss=1.5177, Train Acc=53.38% | Val Loss=1.6091, Val Acc=50.46% | Time: 17.44s
2025-04-21 21:24:38,705 | INFO | New best model saved (val loss = 1.6091)
2025-04-21 21:24:56,270 | INFO | Epoch 5: Train Loss=1.4460, Train Acc=56.60% | Val Loss=1.4783, Val Acc=54.66% | Time: 17.56s
2025-04-21 21:24:56,271 | INFO | New best model saved (val loss = 1.4783)
2025-04-21 21:25:13,870 | INFO | Epoch 6: Train Loss=1.3841, Train Acc=59.72% | Val Loss=1.4545, Val Acc=57.26% | Time: 17.60s
2025-04-21 21:25:13,871 | INFO | New best model saved (val loss = 1.4545)
2025-04-21 21:25:31,386 | INFO | Epoch 7: Train Loss=1.3500, Train Acc=61.56% | Val Loss=1.4559, Val Acc=59.14% | Time: 17.51s
2025-04-21 21:25:48,961 | INFO | Epoch 8: Train Loss=1.3118, Train Acc=63.12% | Val Loss=1.3499, Val Acc=61.56% | Time: 17.57s
2025-04-21 21:25:48,962 | INFO | New best model saved (val loss = 1.3499)
2025-04-21 21:26:06,470 | INFO | Epoch 9: Train Loss=1.2714, Train Acc=65.14% | Val Loss=1.2879, Val Acc=63.66% | Time: 17.51s
2025-04-21 21:26:06,471 | INFO | New best model saved (val loss = 1.2879)
2025-04-21 21:26:23,881 | INFO | Epoch 10: Train Loss=1.2488, Train Acc=66.26% | Val Loss=1.2565, Val Acc=66.28% | Time: 17.41s
2025-04-21 21:26:23,882 | INFO | New best model saved (val loss = 1.2565)
2025-04-21 21:26:41,440 | INFO | Epoch 11: Train Loss=1.2175, Train Acc=67.84% | Val Loss=1.2511, Val Acc=66.60% | Time: 17.56s
2025-04-21 21:26:41,441 | INFO | New best model saved (val loss = 1.2511)
2025-04-21 21:26:58,880 | INFO | Epoch 12: Train Loss=1.1951, Train Acc=68.99% | Val Loss=1.2328, Val Acc=67.16% | Time: 17.44s
2025-04-21 21:26:58,881 | INFO | New best model saved (val loss = 1.2328)
2025-04-21 21:27:16,292 | INFO | Epoch 13: Train Loss=1.1751, Train Acc=69.81% | Val Loss=1.1727, Val Acc=69.58% | Time: 17.41s
2025-04-21 21:27:16,294 | INFO | New best model saved (val loss = 1.1727)
2025-04-21 21:27:33,714 | INFO | Epoch 14: Train Loss=1.1456, Train Acc=71.33% | Val Loss=1.2519, Val Acc=66.08% | Time: 17.42s
2025-04-21 21:27:51,189 | INFO | Epoch 15: Train Loss=1.1263, Train Acc=72.14% | Val Loss=1.1674, Val Acc=69.98% | Time: 17.47s
2025-04-21 21:27:51,191 | INFO | New best model saved (val loss = 1.1674)
2025-04-21 21:28:08,654 | INFO | Epoch 16: Train Loss=1.1086, Train Acc=73.29% | Val Loss=1.1907, Val Acc=69.04% | Time: 17.46s
2025-04-21 21:28:25,966 | INFO | Epoch 17: Train Loss=1.1048, Train Acc=73.26% | Val Loss=1.1444, Val Acc=70.90% | Time: 17.31s
2025-04-21 21:28:25,967 | INFO | New best model saved (val loss = 1.1444)
2025-04-21 21:28:43,556 | INFO | Epoch 18: Train Loss=1.0819, Train Acc=74.09% | Val Loss=1.1215, Val Acc=72.82% | Time: 17.59s
2025-04-21 21:28:43,557 | INFO | New best model saved (val loss = 1.1215)
2025-04-21 21:29:01,106 | INFO | Epoch 19: Train Loss=1.0635, Train Acc=74.82% | Val Loss=1.1109, Val Acc=72.40% | Time: 17.55s
2025-04-21 21:29:01,107 | INFO | New best model saved (val loss = 1.1109)
2025-04-21 21:29:18,623 | INFO | Epoch 20: Train Loss=1.0521, Train Acc=75.50% | Val Loss=1.1368, Val Acc=71.84% | Time: 17.52s
2025-04-21 21:29:36,214 | INFO | Epoch 21: Train Loss=1.0415, Train Acc=76.11% | Val Loss=1.1318, Val Acc=71.86% | Time: 17.59s
2025-04-21 21:29:53,664 | INFO | Epoch 22: Train Loss=1.0172, Train Acc=77.06% | Val Loss=1.0715, Val Acc=74.82% | Time: 17.45s
2025-04-21 21:29:53,665 | INFO | New best model saved (val loss = 1.0715)
2025-04-21 21:30:11,081 | INFO | Epoch 23: Train Loss=1.0154, Train Acc=77.08% | Val Loss=1.1136, Val Acc=72.62% | Time: 17.42s
2025-04-21 21:30:28,611 | INFO | Epoch 24: Train Loss=0.9944, Train Acc=78.10% | Val Loss=1.1288, Val Acc=72.22% | Time: 17.53s
2025-04-21 21:30:46,094 | INFO | Epoch 25: Train Loss=0.9934, Train Acc=78.26% | Val Loss=1.0403, Val Acc=75.82% | Time: 17.48s
2025-04-21 21:30:46,095 | INFO | New best model saved (val loss = 1.0403)
2025-04-21 21:31:03,672 | INFO | Epoch 26: Train Loss=0.9797, Train Acc=78.83% | Val Loss=1.0572, Val Acc=74.84% | Time: 17.58s
2025-04-21 21:31:21,028 | INFO | Epoch 27: Train Loss=0.9734, Train Acc=79.18% | Val Loss=1.0299, Val Acc=76.74% | Time: 17.35s
2025-04-21 21:31:21,030 | INFO | New best model saved (val loss = 1.0299)
2025-04-21 21:31:38,525 | INFO | Epoch 28: Train Loss=0.9687, Train Acc=79.15% | Val Loss=1.0178, Val Acc=76.72% | Time: 17.50s
2025-04-21 21:31:38,526 | INFO | New best model saved (val loss = 1.0178)
2025-04-21 21:31:55,788 | INFO | Epoch 29: Train Loss=0.9548, Train Acc=79.98% | Val Loss=1.0291, Val Acc=76.24% | Time: 17.26s
2025-04-21 21:32:13,077 | INFO | Epoch 30: Train Loss=0.9536, Train Acc=79.86% | Val Loss=1.0323, Val Acc=76.24% | Time: 17.29s
2025-04-21 21:32:30,651 | INFO | Epoch 31: Train Loss=0.9410, Train Acc=80.52% | Val Loss=1.0491, Val Acc=75.30% | Time: 17.57s
2025-04-21 21:32:48,173 | INFO | Epoch 32: Train Loss=0.9301, Train Acc=81.08% | Val Loss=1.0125, Val Acc=77.68% | Time: 17.52s
2025-04-21 21:32:48,174 | INFO | New best model saved (val loss = 1.0125)
2025-04-21 21:33:05,468 | INFO | Epoch 33: Train Loss=0.9234, Train Acc=81.44% | Val Loss=1.0440, Val Acc=75.70% | Time: 17.29s
2025-04-21 21:33:22,880 | INFO | Epoch 34: Train Loss=0.9212, Train Acc=81.46% | Val Loss=1.0109, Val Acc=77.32% | Time: 17.41s
2025-04-21 21:33:22,881 | INFO | New best model saved (val loss = 1.0109)
2025-04-21 21:33:40,430 | INFO | Epoch 35: Train Loss=0.9135, Train Acc=81.77% | Val Loss=1.0180, Val Acc=76.46% | Time: 17.55s
2025-04-21 21:33:57,876 | INFO | Epoch 36: Train Loss=0.9071, Train Acc=82.08% | Val Loss=1.0033, Val Acc=77.86% | Time: 17.45s
2025-04-21 21:33:57,877 | INFO | New best model saved (val loss = 1.0033)
2025-04-21 21:34:15,364 | INFO | Epoch 37: Train Loss=0.9036, Train Acc=82.22% | Val Loss=1.0122, Val Acc=77.30% | Time: 17.49s
2025-04-21 21:34:32,741 | INFO | Epoch 38: Train Loss=0.8990, Train Acc=82.24% | Val Loss=0.9872, Val Acc=78.20% | Time: 17.38s
2025-04-21 21:34:32,742 | INFO | New best model saved (val loss = 0.9872)
2025-04-21 21:34:50,242 | INFO | Epoch 39: Train Loss=0.8922, Train Acc=82.50% | Val Loss=0.9833, Val Acc=78.82% | Time: 17.50s
2025-04-21 21:34:50,243 | INFO | New best model saved (val loss = 0.9833)
2025-04-21 21:35:07,615 | INFO | Epoch 40: Train Loss=0.8915, Train Acc=82.66% | Val Loss=0.9926, Val Acc=78.14% | Time: 17.37s
2025-04-21 21:35:25,045 | INFO | Epoch 41: Train Loss=0.8844, Train Acc=82.87% | Val Loss=0.9912, Val Acc=78.10% | Time: 17.43s
2025-04-21 21:35:42,611 | INFO | Epoch 42: Train Loss=0.8823, Train Acc=83.04% | Val Loss=0.9842, Val Acc=78.66% | Time: 17.57s
2025-04-21 21:36:00,158 | INFO | Epoch 43: Train Loss=0.8704, Train Acc=83.53% | Val Loss=0.9832, Val Acc=78.96% | Time: 17.55s
2025-04-21 21:36:00,159 | INFO | New best model saved (val loss = 0.9832)
2025-04-21 21:36:17,571 | INFO | Epoch 44: Train Loss=0.7929, Train Acc=87.07% | Val Loss=0.8876, Val Acc=83.26% | Time: 17.41s
2025-04-21 21:36:17,573 | INFO | New best model saved (val loss = 0.8876)
2025-04-21 21:36:35,037 | INFO | Epoch 45: Train Loss=0.7594, Train Acc=88.67% | Val Loss=0.8802, Val Acc=83.00% | Time: 17.46s
2025-04-21 21:36:35,040 | INFO | New best model saved (val loss = 0.8802)
2025-04-21 21:36:52,449 | INFO | Epoch 46: Train Loss=0.7476, Train Acc=89.24% | Val Loss=0.8726, Val Acc=83.46% | Time: 17.41s
2025-04-21 21:36:52,450 | INFO | New best model saved (val loss = 0.8726)
2025-04-21 21:37:10,003 | INFO | Epoch 47: Train Loss=0.7408, Train Acc=89.40% | Val Loss=0.8713, Val Acc=83.80% | Time: 17.55s
2025-04-21 21:37:10,004 | INFO | New best model saved (val loss = 0.8713)
2025-04-21 21:37:27,520 | INFO | Epoch 48: Train Loss=0.7307, Train Acc=89.88% | Val Loss=0.8799, Val Acc=83.80% | Time: 17.52s
2025-04-21 21:37:44,784 | INFO | Epoch 49: Train Loss=0.7289, Train Acc=89.95% | Val Loss=0.8697, Val Acc=84.00% | Time: 17.26s
2025-04-21 21:37:44,786 | INFO | New best model saved (val loss = 0.8697)
2025-04-21 21:38:02,348 | INFO | Epoch 50: Train Loss=0.7232, Train Acc=90.23% | Val Loss=0.8678, Val Acc=83.58% | Time: 17.56s
2025-04-21 21:38:02,350 | INFO | New best model saved (val loss = 0.8678)
2025-04-21 21:38:02,428 | INFO | Best model with lowest val loss 0.8677991300821304 at 49 epoch is saved.
2025-04-21 21:38:03,874 | INFO | Test Accuracy: 13.51%
2025-04-21 21:38:03,963 | INFO | Last model with val loss 0.8677991300821304 at 49 epoch is saved.
2025-04-21 21:38:05,231 | INFO | Test Accuracy: 13.51%
2025-04-21 21:38:05,247 | INFO | 
Job Completed
