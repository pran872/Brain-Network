2025-04-20 16:33:05,650 | INFO | Job Started
2025-04-20 16:33:05,650 | INFO | Logging run: /rds/general/user/psp20/home/Brain-Network/runs/resnet_m32_20250420-163305
2025-04-20 16:33:05,650 | INFO | Config:
{
  "seed": 42,
  "run_name": "resnet_m32",
  "model_type": "resnet18",
  "optimizer": "adam",
  "scheduler": "ReduceLROnPlateau",
  "criterion": "CE",
  "label_smoothing": 0,
  "train_split": 0.9,
  "batch_size": 64,
  "num_workers": 2,
  "lr": 0.001,
  "epochs": 50,
  "ema": false,
  "early_stopping": true,
  "min_diff": 0.001,
  "writer": true,
  "patience": 10,
  "use_flex": false,
  "use_pos_embed": false,
  "add_dropout": false,
  "mlp_end": false,
  "add_cls_token": false,
  "num_layers": 2,
  "trans_dropout_ratio": 0.0,
  "standard_scale": false,
  "transform_type": "custom",
  "downsample_fraction": 0,
  "few_shot": 100,
  "attacker": false,
  "epsilon": false,
  "gaussian_std": false
}
2025-04-20 16:33:05,922 | INFO | Using device: cuda
2025-04-20 16:33:05,922 | INFO | Training for 50 epochs
2025-04-20 16:33:05,922 | INFO | Debug mode: False
2025-04-20 16:33:05,922 | INFO | Downsampling by: 0
2025-04-20 16:33:06,209 | INFO | Using custom transform
2025-04-20 16:33:08,025 | INFO | Full train/val size with downsampling (0): 1000
2025-04-20 16:33:08,225 | INFO | Label smoothing: 0
2025-04-20 16:33:09,148 | INFO | Epoch 1: Train Loss=2.2406, Train Acc=21.67% | Val Loss=3.9183, Val Acc=13.00% | Time: 0.92s
2025-04-20 16:33:09,149 | INFO | New best model saved (val loss = 3.9183)
2025-04-20 16:33:09,660 | INFO | Epoch 2: Train Loss=1.9993, Train Acc=26.89% | Val Loss=2.8754, Val Acc=27.00% | Time: 0.51s
2025-04-20 16:33:09,661 | INFO | New best model saved (val loss = 2.8754)
2025-04-20 16:33:10,182 | INFO | Epoch 3: Train Loss=1.9620, Train Acc=29.78% | Val Loss=2.8408, Val Acc=16.00% | Time: 0.52s
2025-04-20 16:33:10,183 | INFO | New best model saved (val loss = 2.8408)
2025-04-20 16:33:10,690 | INFO | Epoch 4: Train Loss=1.7875, Train Acc=31.89% | Val Loss=1.9781, Val Acc=18.00% | Time: 0.51s
2025-04-20 16:33:10,692 | INFO | New best model saved (val loss = 1.9781)
2025-04-20 16:33:11,193 | INFO | Epoch 5: Train Loss=1.7016, Train Acc=37.44% | Val Loss=2.1157, Val Acc=25.00% | Time: 0.50s
2025-04-20 16:33:11,693 | INFO | Epoch 6: Train Loss=1.6308, Train Acc=38.33% | Val Loss=1.9760, Val Acc=27.00% | Time: 0.50s
2025-04-20 16:33:11,694 | INFO | New best model saved (val loss = 1.9760)
2025-04-20 16:33:12,224 | INFO | Epoch 7: Train Loss=1.6005, Train Acc=42.11% | Val Loss=1.9039, Val Acc=34.00% | Time: 0.53s
2025-04-20 16:33:12,225 | INFO | New best model saved (val loss = 1.9039)
2025-04-20 16:33:12,719 | INFO | Epoch 8: Train Loss=1.6505, Train Acc=41.00% | Val Loss=2.0482, Val Acc=33.00% | Time: 0.49s
2025-04-20 16:33:13,217 | INFO | Epoch 9: Train Loss=1.6410, Train Acc=40.44% | Val Loss=2.5301, Val Acc=25.00% | Time: 0.50s
2025-04-20 16:33:13,715 | INFO | Epoch 10: Train Loss=1.5995, Train Acc=39.78% | Val Loss=1.9594, Val Acc=28.00% | Time: 0.50s
2025-04-20 16:33:14,211 | INFO | Epoch 11: Train Loss=1.4551, Train Acc=46.56% | Val Loss=2.3547, Val Acc=32.00% | Time: 0.50s
2025-04-20 16:33:14,714 | INFO | Epoch 12: Train Loss=1.3941, Train Acc=52.33% | Val Loss=1.7976, Val Acc=37.00% | Time: 0.50s
2025-04-20 16:33:14,715 | INFO | New best model saved (val loss = 1.7976)
2025-04-20 16:33:15,215 | INFO | Epoch 13: Train Loss=1.2933, Train Acc=56.22% | Val Loss=1.7490, Val Acc=39.00% | Time: 0.50s
2025-04-20 16:33:15,216 | INFO | New best model saved (val loss = 1.7490)
2025-04-20 16:33:15,708 | INFO | Epoch 14: Train Loss=1.2623, Train Acc=57.44% | Val Loss=1.7484, Val Acc=40.00% | Time: 0.49s
2025-04-20 16:33:15,709 | INFO | New best model saved (val loss = 1.7484)
2025-04-20 16:33:16,200 | INFO | Epoch 15: Train Loss=1.1699, Train Acc=57.44% | Val Loss=1.6905, Val Acc=42.00% | Time: 0.49s
2025-04-20 16:33:16,201 | INFO | New best model saved (val loss = 1.6905)
2025-04-20 16:33:16,719 | INFO | Epoch 16: Train Loss=1.2192, Train Acc=59.00% | Val Loss=1.6774, Val Acc=38.00% | Time: 0.52s
2025-04-20 16:33:16,720 | INFO | New best model saved (val loss = 1.6774)
2025-04-20 16:33:17,207 | INFO | Epoch 17: Train Loss=1.2009, Train Acc=59.56% | Val Loss=1.6510, Val Acc=47.00% | Time: 0.49s
2025-04-20 16:33:17,208 | INFO | New best model saved (val loss = 1.6510)
2025-04-20 16:33:17,711 | INFO | Epoch 18: Train Loss=1.1261, Train Acc=60.67% | Val Loss=1.7058, Val Acc=40.00% | Time: 0.50s
2025-04-20 16:33:18,224 | INFO | Epoch 19: Train Loss=1.0882, Train Acc=59.89% | Val Loss=1.6368, Val Acc=44.00% | Time: 0.51s
2025-04-20 16:33:18,236 | INFO | New best model saved (val loss = 1.6368)
2025-04-20 16:33:18,751 | INFO | Epoch 20: Train Loss=1.1214, Train Acc=62.22% | Val Loss=1.6510, Val Acc=49.00% | Time: 0.52s
2025-04-20 16:33:19,245 | INFO | Epoch 21: Train Loss=1.0553, Train Acc=63.11% | Val Loss=1.7085, Val Acc=43.00% | Time: 0.49s
2025-04-20 16:33:19,771 | INFO | Epoch 22: Train Loss=1.0538, Train Acc=63.00% | Val Loss=1.5718, Val Acc=48.00% | Time: 0.53s
2025-04-20 16:33:19,772 | INFO | New best model saved (val loss = 1.5718)
2025-04-20 16:33:20,265 | INFO | Epoch 23: Train Loss=1.0036, Train Acc=62.56% | Val Loss=1.6566, Val Acc=43.00% | Time: 0.49s
2025-04-20 16:33:20,753 | INFO | Epoch 24: Train Loss=1.0472, Train Acc=64.11% | Val Loss=1.6263, Val Acc=46.00% | Time: 0.49s
2025-04-20 16:33:21,245 | INFO | Epoch 25: Train Loss=1.0268, Train Acc=63.11% | Val Loss=1.7413, Val Acc=40.00% | Time: 0.49s
2025-04-20 16:33:21,771 | INFO | Epoch 26: Train Loss=1.0018, Train Acc=64.67% | Val Loss=1.6689, Val Acc=49.00% | Time: 0.53s
2025-04-20 16:33:22,261 | INFO | Epoch 27: Train Loss=0.9433, Train Acc=66.22% | Val Loss=1.6242, Val Acc=47.00% | Time: 0.49s
2025-04-20 16:33:22,771 | INFO | Epoch 28: Train Loss=0.9805, Train Acc=68.89% | Val Loss=1.5876, Val Acc=48.00% | Time: 0.51s
2025-04-20 16:33:23,283 | INFO | Epoch 29: Train Loss=0.9428, Train Acc=69.33% | Val Loss=1.6436, Val Acc=50.00% | Time: 0.51s
2025-04-20 16:33:23,779 | INFO | Epoch 30: Train Loss=0.9204, Train Acc=67.44% | Val Loss=1.6497, Val Acc=43.00% | Time: 0.50s
2025-04-20 16:33:24,292 | INFO | Epoch 31: Train Loss=0.9436, Train Acc=68.22% | Val Loss=1.6279, Val Acc=47.00% | Time: 0.51s
2025-04-20 16:33:24,781 | INFO | Epoch 32: Train Loss=0.8719, Train Acc=68.56% | Val Loss=1.6799, Val Acc=49.00% | Time: 0.49s
2025-04-20 16:33:24,781 | INFO | Early stopping triggered at epoch 32
2025-04-20 16:33:24,844 | INFO | Best model with lowest val loss 1.571848213672638 at 21 epoch is saved.
2025-04-20 16:33:25,651 | INFO | Test Accuracy: 47.69% | Test Loss: 1.54
2025-04-20 16:33:25,738 | INFO | Last model with val loss 1.6798539757728577 at 31 epoch is saved.
2025-04-20 16:33:26,539 | INFO | Test Accuracy: 47.69% | Test Loss: 1.54
2025-04-20 16:33:26,551 | INFO | 
Job Completed
