2025-04-21 19:03:24,684 | INFO | Job Started
2025-04-21 19:03:24,685 | INFO | Logging run: /rds/general/user/psp20/home/Brain-Network/runs/zoom_m60_20250421-190324
2025-04-21 19:03:24,685 | INFO | Config:
{
  "seed": 42,
  "run_name": "zoom_m60",
  "model_type": "zoom",
  "optimizer": "adam",
  "scheduler": "ReduceLROnPlateau",
  "criterion": "CE",
  "label_smoothing": 0.1,
  "train_split": 0.9,
  "batch_size": 256,
  "num_workers": 2,
  "lr": 0.001,
  "epochs": 50,
  "ema": false,
  "early_stopping": true,
  "min_diff": 0.001,
  "writer": true,
  "patience": 10,
  "use_flex": false,
  "use_pos_embed": true,
  "add_dropout": false,
  "mlp_end": false,
  "add_cls_token": true,
  "num_layers": 2,
  "trans_dropout_ratio": 0.0,
  "standard_scale": true,
  "resnet_layers": 4,
  "multiscale_tokenisation": true,
  "gamma_per_head": true,
  "use_token_mixer": false,
  "remove_zoom": false,
  "transform_type": "custom",
  "downsample_fraction": 0,
  "few_shot": false,
  "freeze_resnet_early": false,
  "attacker": false,
  "epsilon": false,
  "gaussian_std": false
}
2025-04-21 19:03:24,785 | INFO | Using device: cuda
2025-04-21 19:03:24,786 | INFO | Training for 50 epochs
2025-04-21 19:03:24,786 | INFO | Debug mode: False
2025-04-21 19:03:24,786 | INFO | Downsampling by: 0
2025-04-21 19:03:25,365 | INFO | Using custom transform
2025-04-21 19:03:26,828 | INFO | Full train/val size with downsampling (0): 50000
2025-04-21 19:03:26,830 | INFO | Label smoothing: 0.1
2025-04-21 19:03:41,322 | INFO | Epoch 1: Train Loss=1.8595, Train Acc=33.49% | Val Loss=1.6727, Val Acc=43.62% | Time: 14.49s
2025-04-21 19:03:41,323 | INFO | New best model saved (val loss = 1.6727)
2025-04-21 19:03:54,430 | INFO | Epoch 2: Train Loss=1.4933, Train Acc=53.32% | Val Loss=1.5564, Val Acc=52.36% | Time: 13.11s
2025-04-21 19:03:54,431 | INFO | New best model saved (val loss = 1.5564)
2025-04-21 19:04:07,653 | INFO | Epoch 3: Train Loss=1.2832, Train Acc=64.36% | Val Loss=1.5174, Val Acc=55.36% | Time: 13.22s
2025-04-21 19:04:07,654 | INFO | New best model saved (val loss = 1.5174)
2025-04-21 19:04:20,803 | INFO | Epoch 4: Train Loss=1.1633, Train Acc=70.03% | Val Loss=1.2891, Val Acc=65.28% | Time: 13.15s
2025-04-21 19:04:20,804 | INFO | New best model saved (val loss = 1.2891)
2025-04-21 19:04:33,969 | INFO | Epoch 5: Train Loss=1.0717, Train Acc=74.55% | Val Loss=1.2289, Val Acc=68.32% | Time: 13.16s
2025-04-21 19:04:33,970 | INFO | New best model saved (val loss = 1.2289)
2025-04-21 19:04:47,103 | INFO | Epoch 6: Train Loss=1.0001, Train Acc=77.87% | Val Loss=1.0516, Val Acc=76.36% | Time: 13.13s
2025-04-21 19:04:47,104 | INFO | New best model saved (val loss = 1.0516)
2025-04-21 19:05:00,252 | INFO | Epoch 7: Train Loss=0.9503, Train Acc=80.48% | Val Loss=1.0210, Val Acc=78.14% | Time: 13.15s
2025-04-21 19:05:00,253 | INFO | New best model saved (val loss = 1.0210)
2025-04-21 19:05:13,397 | INFO | Epoch 8: Train Loss=0.9104, Train Acc=82.10% | Val Loss=0.9830, Val Acc=79.08% | Time: 13.14s
2025-04-21 19:05:13,399 | INFO | New best model saved (val loss = 0.9830)
2025-04-21 19:05:26,593 | INFO | Epoch 9: Train Loss=0.8799, Train Acc=83.64% | Val Loss=0.9928, Val Acc=78.12% | Time: 13.19s
2025-04-21 19:05:39,778 | INFO | Epoch 10: Train Loss=0.8572, Train Acc=84.58% | Val Loss=0.9345, Val Acc=81.00% | Time: 13.18s
2025-04-21 19:05:39,780 | INFO | New best model saved (val loss = 0.9345)
2025-04-21 19:05:52,971 | INFO | Epoch 11: Train Loss=0.8309, Train Acc=85.57% | Val Loss=1.0327, Val Acc=77.36% | Time: 13.19s
2025-04-21 19:06:06,139 | INFO | Epoch 12: Train Loss=0.8064, Train Acc=86.78% | Val Loss=0.9134, Val Acc=82.00% | Time: 13.16s
2025-04-21 19:06:06,140 | INFO | New best model saved (val loss = 0.9134)
2025-04-21 19:06:19,323 | INFO | Epoch 13: Train Loss=0.7960, Train Acc=87.30% | Val Loss=0.9153, Val Acc=81.90% | Time: 13.18s
2025-04-21 19:06:32,511 | INFO | Epoch 14: Train Loss=0.7846, Train Acc=87.82% | Val Loss=0.9111, Val Acc=82.00% | Time: 13.18s
2025-04-21 19:06:32,513 | INFO | New best model saved (val loss = 0.9111)
2025-04-21 19:06:45,786 | INFO | Epoch 15: Train Loss=0.7654, Train Acc=88.48% | Val Loss=0.8893, Val Acc=83.22% | Time: 13.27s
2025-04-21 19:06:45,787 | INFO | New best model saved (val loss = 0.8893)
2025-04-21 19:06:58,973 | INFO | Epoch 16: Train Loss=0.7575, Train Acc=88.95% | Val Loss=0.8393, Val Acc=85.54% | Time: 13.18s
2025-04-21 19:06:58,974 | INFO | New best model saved (val loss = 0.8393)
2025-04-21 19:07:12,164 | INFO | Epoch 17: Train Loss=0.7444, Train Acc=89.52% | Val Loss=0.8484, Val Acc=85.10% | Time: 13.19s
2025-04-21 19:07:25,359 | INFO | Epoch 18: Train Loss=0.7338, Train Acc=89.97% | Val Loss=0.8240, Val Acc=86.00% | Time: 13.19s
2025-04-21 19:07:25,361 | INFO | New best model saved (val loss = 0.8240)
2025-04-21 19:07:38,558 | INFO | Epoch 19: Train Loss=0.7205, Train Acc=90.55% | Val Loss=0.8467, Val Acc=84.92% | Time: 13.19s
2025-04-21 19:07:51,755 | INFO | Epoch 20: Train Loss=0.7132, Train Acc=90.92% | Val Loss=0.8561, Val Acc=85.22% | Time: 13.19s
2025-04-21 19:08:04,961 | INFO | Epoch 21: Train Loss=0.7063, Train Acc=91.13% | Val Loss=0.7713, Val Acc=88.16% | Time: 13.20s
2025-04-21 19:08:04,962 | INFO | New best model saved (val loss = 0.7713)
2025-04-21 19:08:18,159 | INFO | Epoch 22: Train Loss=0.6973, Train Acc=91.43% | Val Loss=0.8719, Val Acc=85.12% | Time: 13.19s
2025-04-21 19:08:31,321 | INFO | Epoch 23: Train Loss=0.6948, Train Acc=91.67% | Val Loss=0.7943, Val Acc=87.60% | Time: 13.16s
2025-04-21 19:08:44,491 | INFO | Epoch 24: Train Loss=0.6878, Train Acc=91.95% | Val Loss=0.8045, Val Acc=87.30% | Time: 13.16s
2025-04-21 19:08:57,657 | INFO | Epoch 25: Train Loss=0.6778, Train Acc=92.34% | Val Loss=0.8173, Val Acc=87.20% | Time: 13.16s
2025-04-21 19:09:10,846 | INFO | Epoch 26: Train Loss=0.6098, Train Acc=95.37% | Val Loss=0.7054, Val Acc=91.12% | Time: 13.18s
2025-04-21 19:09:10,847 | INFO | New best model saved (val loss = 0.7054)
2025-04-21 19:09:24,100 | INFO | Epoch 27: Train Loss=0.5836, Train Acc=96.54% | Val Loss=0.7015, Val Acc=91.52% | Time: 13.25s
2025-04-21 19:09:24,101 | INFO | New best model saved (val loss = 0.7015)
2025-04-21 19:09:37,252 | INFO | Epoch 28: Train Loss=0.5763, Train Acc=96.83% | Val Loss=0.6873, Val Acc=92.20% | Time: 13.14s
2025-04-21 19:09:37,253 | INFO | New best model saved (val loss = 0.6873)
2025-04-21 19:09:50,426 | INFO | Epoch 29: Train Loss=0.5695, Train Acc=97.16% | Val Loss=0.6988, Val Acc=91.66% | Time: 13.17s
2025-04-21 19:10:03,600 | INFO | Epoch 30: Train Loss=0.5630, Train Acc=97.49% | Val Loss=0.6924, Val Acc=91.72% | Time: 13.17s
2025-04-21 19:10:16,794 | INFO | Epoch 31: Train Loss=0.5578, Train Acc=97.65% | Val Loss=0.6969, Val Acc=91.52% | Time: 13.19s
2025-04-21 19:10:29,989 | INFO | Epoch 32: Train Loss=0.5550, Train Acc=97.79% | Val Loss=0.6892, Val Acc=92.18% | Time: 13.19s
2025-04-21 19:10:43,156 | INFO | Epoch 33: Train Loss=0.5487, Train Acc=98.03% | Val Loss=0.6956, Val Acc=92.24% | Time: 13.16s
2025-04-21 19:10:56,313 | INFO | Epoch 34: Train Loss=0.5465, Train Acc=98.16% | Val Loss=0.6842, Val Acc=92.48% | Time: 13.15s
2025-04-21 19:10:56,314 | INFO | New best model saved (val loss = 0.6842)
2025-04-21 19:11:09,482 | INFO | Epoch 35: Train Loss=0.5444, Train Acc=98.29% | Val Loss=0.6935, Val Acc=92.44% | Time: 13.16s
2025-04-21 19:11:22,658 | INFO | Epoch 36: Train Loss=0.5471, Train Acc=98.11% | Val Loss=0.6905, Val Acc=92.24% | Time: 13.17s
2025-04-21 19:11:35,854 | INFO | Epoch 37: Train Loss=0.5439, Train Acc=98.30% | Val Loss=0.6957, Val Acc=91.94% | Time: 13.19s
2025-04-21 19:11:49,025 | INFO | Epoch 38: Train Loss=0.5440, Train Acc=98.27% | Val Loss=0.6954, Val Acc=92.18% | Time: 13.16s
2025-04-21 19:12:02,194 | INFO | Epoch 39: Train Loss=0.5424, Train Acc=98.33% | Val Loss=0.6977, Val Acc=92.26% | Time: 13.16s
2025-04-21 19:12:15,389 | INFO | Epoch 40: Train Loss=0.5419, Train Acc=98.38% | Val Loss=0.6842, Val Acc=92.62% | Time: 13.18s
2025-04-21 19:12:15,391 | INFO | New best model saved (val loss = 0.6842)
2025-04-21 19:12:28,565 | INFO | Epoch 41: Train Loss=0.5411, Train Acc=98.40% | Val Loss=0.6979, Val Acc=91.88% | Time: 13.16s
2025-04-21 19:12:41,740 | INFO | Epoch 42: Train Loss=0.5417, Train Acc=98.41% | Val Loss=0.6831, Val Acc=92.82% | Time: 13.17s
2025-04-21 19:12:41,742 | INFO | New best model saved (val loss = 0.6831)
2025-04-21 19:12:54,929 | INFO | Epoch 43: Train Loss=0.5399, Train Acc=98.48% | Val Loss=0.6882, Val Acc=92.32% | Time: 13.18s
2025-04-21 19:13:08,093 | INFO | Epoch 44: Train Loss=0.5416, Train Acc=98.38% | Val Loss=0.6916, Val Acc=92.08% | Time: 13.15s
2025-04-21 19:13:21,280 | INFO | Epoch 45: Train Loss=0.5409, Train Acc=98.45% | Val Loss=0.6898, Val Acc=92.26% | Time: 13.18s
2025-04-21 19:13:34,474 | INFO | Epoch 46: Train Loss=0.5408, Train Acc=98.44% | Val Loss=0.6958, Val Acc=92.30% | Time: 13.18s
2025-04-21 19:13:47,659 | INFO | Epoch 47: Train Loss=0.5403, Train Acc=98.47% | Val Loss=0.7016, Val Acc=91.82% | Time: 13.17s
2025-04-21 19:14:00,853 | INFO | Epoch 48: Train Loss=0.5406, Train Acc=98.43% | Val Loss=0.6925, Val Acc=92.22% | Time: 13.18s
2025-04-21 19:14:14,049 | INFO | Epoch 49: Train Loss=0.5387, Train Acc=98.49% | Val Loss=0.6824, Val Acc=92.46% | Time: 13.18s
2025-04-21 19:14:14,050 | INFO | New best model saved (val loss = 0.6824)
2025-04-21 19:14:27,291 | INFO | Epoch 50: Train Loss=0.5406, Train Acc=98.42% | Val Loss=0.6861, Val Acc=92.74% | Time: 13.23s
2025-04-21 19:14:27,368 | INFO | Best model with lowest val loss 0.6823515862226486 at 48 epoch is saved.
2025-04-21 19:14:28,755 | INFO | Test Accuracy: 92.31%
2025-04-21 19:14:28,837 | INFO | Last model with val loss 0.6860830038785934 at 49 epoch is saved.
2025-04-21 19:14:30,134 | INFO | Test Accuracy: 92.31%
2025-04-21 19:14:30,143 | INFO | 
Job Completed
